# 计划：trace 回放器 UI 优化（主题/交点/界面）

目标：为 `viewer/` 增加浅色主题（默认跟随系统偏好，可手动切换并持久化），提升交点可见性（当前步/累计交点），并优化整体界面显示效果。

## 验收标准
- 在系统浅色/深色模式下，首次打开默认跟随系统偏好显示。
- 工具栏提供主题选项：`跟随系统 / 浅色 / 深色`；选择会写入 `localStorage` 并在刷新后保持。
- “累计交点”开关可控制是否绘制累计交点，默认开启，刷新后保持。
- 交点在两主题下都清晰可见（更大半径 + 描边/对比度增强），高 DPI 下尺寸一致。
- 视觉风格：浅灰面板风（现代、克制），文本/边框对比度充足，按钮/列表 hover/active 明确。
- 不引入构建依赖，仍保持纯静态离线运行（`cd viewer && python3 -m http.server 8000`）。

## 待办
- [x] 添加主题变量与浅色主题（CSS）
- [x] 工具栏增加主题切换（system/light/dark）
- [x] Canvas 绘制颜色改为跟随主题变量
- [x] 加大交点绘制（当前步 + 累计），并做 DPI 适配
- [x] 增加“累计交点”显示开关（含持久化）
- [x] 优化界面样式（面板/按钮/列表/表格/响应式）
- [x] 运行静态语法检查（`node --check viewer/app.js`）并手工走一遍关键交互
- [x] 更新 `viewer/README.md` 的使用说明并做最终回归
- [x] 增加交点大小控制（当前步/累计，可持久化）
- [x] 优化激活线段高亮策略：默认不加粗，仅增强颜色/透明度（可切换）
- [ ] 修复：当前交点大小不生效（避免与累计层重复绘制）
